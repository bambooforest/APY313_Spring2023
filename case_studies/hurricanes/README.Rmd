---
title: "Hurricanes"
author: "Steven Moran & Nicholas A. Lester"
date: "2022-10-08"
output: 
  html_document:
    toc: true
---

```{r, message=FALSE, echo=FALSE}
library(tidyverse)
```

<!--

# Todos

NAL:

* I think you want frequency or one-hot
* Cuz many hurricanes happen, so Poisson with year as predictor. But also “did x event occur” I.e. binary or Cox)
* Mosaic plots of category vs year is way to start
* You can also turn year (more) continuous if you treat it as position within year (I.e., day that it made landfall or transitioned from tropical storm or increased in strength or…. Then let it interact with year. Or a more general variable “time to first landfall of biggest hurricane from last confirmed landfall). I don’t know, but sounds fun.
-->

# Introduction

A [hurricane](https://en.wiktionary.org/wiki/hurricane) is a tropical cyclone that can appear in the Caribbean (also North Atlantic or North Pacific off of Mexico). It is a storm with violent wind, rain, and in temperate latitudes thunder and lightning. 

In English the word "hurrican" was borred from Spanish "huracán", which ultimately has its roots in the [Taíno](https://en.wikipedia.org/wiki/Ta%C3%ADno_language) word "*hurakā". Taíno is an extinct language from the [Arawakan language family](https://en.wikipedia.org/wiki/Arawakan_languages). Before Spanish contact, it was the most populous language spoken in the Caribbean and many words from objects in this area survive in Spanish and English borrowings, e.g., barbacoa (barbeque), guayaba (guava), tabaco (tabacco).

Hurricanes are measured in terms of intensity of wind speed. For example, the [Saffir-Simpson Hurricane Wind Scale](https://www.nhc.noaa.gov/aboutsshws.php) gives a rating of 1 to 5 based a hurricane's maximum sustained wind speed. Category 1 includes hurricanes that with sustained winds of 74-95 mph / 64-82 kt / 119-153 km/h. These are considered very dangerous and will produce some damage. The strongest hurricanes are level 5, where wind speeds reach 157 mph / 137 kt / 252 km/h or higher. These are catastrophic in terms of damage from winds and flooding.

Although category 5 hurricanes are [reportedly rare in the US](https://www.npr.org/2022/09/28/1125567621/hurricane-ian-category-5-storms-2022-florida) (only four in history), they are devastating. For example, hurricane Andrew (1992) destroyed an estimated 50,000 homes and the damage was around $26 billion. However, even lesser category hurricanes can be devestating in terms of lives lost and damage. Katrina (2005) was a category 3 hurricane that caused over 1800 fatalities and $125 billion in damage. New Orleans and surrounding areas were particularly hard hit. Its economic, environmental, and cultural impacts are still felt.

Recently, in the news the question of whether climate change is causing hurricanes to become more intense and/or more frequent is a topic of debate. 

For example, this article describes them as getting stronger, i.e., more intense due to factors such as warming oceans:

* https://www.nytimes.com/2020/05/18/climate/climate-changes-hurricane-intensity.html

However, this article states that they are not getting stronger:

* https://www.forbes.com/sites/rogerpielke/2019/11/15/no-hurricanes-are-not-bigger-stronger-and-more-dangerous/

This report also suggests they are not getting stronger, however more frequent:

* https://www.sciencenews.org/article/hurricanes-frequency-danger-climate-change-atlantic

This article also suggests they are getting more frequent, but due to a rebound in the 1980s after a lull since the 1960s:

https://www.carbonbrief.org/recent-increase-in-major-atlantic-hurricanes-may-be-rebound-after-1960-1980s-lull/

The above article is based on a published research article in *Nature Communications*:

* https://www.nature.com/articles/s41467-021-24268-5

The abstract:

>>> Atlantic hurricanes are a major hazard to life and property, and a topic of intense scientific interest. Historical changes in observing practices limit the utility of century-scale records of Atlantic major hurricane frequency. To evaluate past changes in frequency, we have here developed a homogenization method for Atlantic hurricane and major hurricane frequency over 1851–2019. We find that recorded century-scale increases in Atlantic hurricane and major hurricane frequency, and associated decrease in USA hurricanes strike fraction, are consistent with changes in observing practices and not likely a true climate trend. After homogenization, increases in basin-wide hurricane and major hurricane activity since the 1970s are not part of a century-scale increase, but a recovery from a deep minimum in the 1960s–1980s. We suggest internal (e.g., Atlantic multidecadal) climate variability and aerosol-induced mid-to-late-20th century major hurricane frequency reductions have probably masked century-scale greenhouse-gas warming contributions to North Atlantic major hurricane frequency.

Thus, they find that the change in frequency is unlikely due to a change in climate.


# Hypothesis

Taken together, there is conflicting evidence on the increase/decrease in frequency and increase/decrease in intensity of hurricane. Thus, we formulate and test the following hypothesis in this report:

- H0: hurricanes are not becoming strong over time
- H1: they are becoming stronger

And:

- H0: hurricanes are not becoming more frequent over time
- H1: they are becoming more frequent

In these formulations, "over time" relates to the data available and "stronger" relates to intensity in terms of hurricane categories.



<!-- 
# Notes

blizzicane
snowicane


Caleb:

"In 2012, the NHC expanded the windspeed range for Category 4 by 1 mph in both directions, to 130–156 mph, with corresponding changes in the other units (113–136 kn, 209–251 km/h), instead of 131–155 mph (114–135 kn, 210–249 km/h)." So not a factor.

These are the three strongest storms recorded in the data. People still talk about the last one, Hurricane Andrew, as it hit UM hard. Apparently the 30's were really active, and also the 2000's, in terms of storms at sea that didn't make landfall.

1935	Sep	FL, SE5, SW5, NW2; I-GA, 1	5	892	160	1930's	18	1.8
1969	Aug	LA, 5; MS, 5; AL, 1	5	900	150	1960's	13	1.3
1992	Aug	FL, SE5, SW4; LA, 3	5	922	145	1990's	14	1.4

* What month are you most likley to have a hurricane?
-->


# Data

Data from [NOAA](https://www.noaa.gov).

```{r}
df <- read.csv('us landfall hurricanes since 1850.csv')
```

# Methods and results

## Stronger over time?

### Linear regression

Are hurricanes getting stronger over time? 

Doesn't look like it according to a basic linear regression on years predicting hurricane category strength.

```{r}
ggplot(df, aes(Year, Category)) +
  geom_point() +
  geom_smooth(method='lm')

model <- lm(Category ~ Year, data=df)
summary(model)
```

### Mosaic plots

Mosaic plot of year vs category (0 = no hurrcanes that year; 1-5 hurricane scale).

All years -- hard to see the labels and the results.

```{r}
t <- table(df$Year, df$Category)
mosaicplot(t)
```

Let's look at just 1900-2020. Still difficult to see much at this scale.

```{r}
tmp <- df %>% filter(Year <= 2020) %>% filter(Year >= 1900)
t <- table(df$Year, df$Category)
mosaicplot(t) # main = ""
```

Data contains a column `Decade` variable. Let's look by decade.

```{r}
t <- table(df$Decade, df$Category)
mosaicplot(t, las=2)
```

***

Create our own decades and have a look from 1900 onwards.

It looks like Category 5's are increasing in rate of occurrence (they appear in only one slice between 1900 and 1960, then in two slices from 1960-1990 (half the time, more instances).   

```{r}
tmp$Decade <- tmp$Year - tmp$Year %% 10
t <- table(tmp$Decade, tmp$Category)
mosaicplot(t, las=2, offset = 0.1)
```

What if we shift to five year intervals?

```{r}
tmp$Decade <- tmp$Year - tmp$Year %% 5
t <- table(tmp$Decade, tmp$Category)
mosaicplot(t, las=2, offset = 0.1)
```


## More frequent over time?

Bar plot. No strong looking trend.

```{r}
h_count <- df %>% group_by(Year) %>% summarize(count = n())
ggplot(data=h_count, aes(x=Year, y=count)) +
  geom_bar(stat="identity")
```

Simple linear regression. No strong trend.

```{r}
ggplot(h_count, aes(Year, count)) +
  geom_point() +
  geom_smooth(method='lm')
```

Let's grouping counts by Category.

It looks like 1 and 2 don't change much over time, but 3 and 4 show a slight increase. None of these trends appears to be statistically significant in their own right nor do they differ from each other. 

```{r}
h_count <- df %>% group_by(Year, Category) %>% summarize(count = n())

h_count$Category = as.factor(h_count$Category)
h_count = h_count %>% 
          filter(is.finite(Year) & is.finite(Category))
ggplot(h_count, aes(x=Year, y=count, color=Category, fill=Category)) +
  geom_point() +
  geom_smooth(method='lm')
```

<!-- 

Some other options we could try:

- binary logistic regression predicting 4/5 vs. 1/2/3
- ordinal regression (multinomial with ranked outcomes)
- max sustained windspeed of storms instead of category?    
--> 

## Density plots for counts before/after 1960

As we can see, not a lot of change. Looks like 4s get taken over a bit by 5s after 1960, and we see increased density of 4-hurricane years (2s and 3s).

```{r}
ggplot(h_count %>% filter(Year <= 1960), aes(x=count, color=Category, fill=Category)) +
  geom_density(alpha=0.2, lwd=1) + 
  ggtitle("Before 1960") +
  ylim(0, 2) + 
  theme_bw()

ggplot(h_count %>% filter(Year > 1960), aes(x=count, color=Category, fill=Category)) +
  geom_density(alpha=0.2, lwd=1) +
  ggtitle("After 1960") +
  ylim(0, 2) + 
  theme_bw()
```

Note, we add zero counts as well.

With this additional info, it looks like the biggest difference is the "rise of the 5s". We see decreasing prevalence of Cat2-4 at higher frequencies. So fewer of the Cat 4 and below storms, but more of the most devastating storms.

In other words, what would have been Cat4s are now sometimes going to Cat5s. Cat1-3 are pretty similar, but perhaps decreasing a bit in prevalence. Cat0s are increased a bit -- perhaps due to what's been reported about changes in aersols in the atmosphere with regard to environmentalist policy.

We could look at other splits, but this one is roughly center.


```{r}
h_count <- df %>% group_by(Year, Category) %>% summarize(count = n())

h_count$Category = as.factor(h_count$Category)
h_count = h_count %>% 
          filter(is.finite(Year) & is.finite(Category)) %>%
          ungroup() %>%
          complete(Year, Category, fill = list(count=0))
          
head(h_count)

ggplot(h_count %>% filter(Year <= 1960), aes(x=count, color=Category, fill=Category)) +
  geom_density(alpha=0.2, lwd=1) + 
  ggtitle("Before 1960") +
  ylim(0, 2.5) + 
  theme_bw()

ggplot(h_count %>% filter(Year > 1960), aes(x=count, color=Category, fill=Category)) +
  geom_density(alpha=0.2, lwd=1) +
  ggtitle("After 1960") +
  ylim(0, 2.5) + 
  theme_bw()
```


## Max wind speeds

Cat5s are getting weaker in the data.

```{r}
library(mgcv)
df2 = df %>%
      filter(grepl("^[0-9]+", Wind.max)) %>%
      mutate(Wind.max = as.numeric(as.vector(Wind.max)),
             tWind.max = Wind.max^0.5,
             Category = factor(Category))


model <- gam(tWind.max ~ s(Year, by=Category), data=df2)
summary(model)
plot(model, sel=5, shade=T)
qqnorm(resid(model))

ggplot(df2, aes(x = Year, y  = Wind.max, color = Category)) +
      geom_point() +
      geom_smooth(method="lm", formula=y~poly(x, 2)) +
      theme_bw()
```

<!-- Category versus year.

```{r}
ggplot(data=df, aes(x=Year, y=Category, fill=Category)) +
  geom_bar(position="stack", stat="identity")
```

```{r}
ggplot(data=df, aes(x=Year, y=Category, fill=Category)) +
  geom_bar(position="fill", stat="identity")
```

```{r``````}
ggplot(data=tmp, aes(x=Year, y=Category, fill=Category)) +
  geom_bar(position="fill", stat="identity")
```

-->

# Time series analysis





# Discussion / Conclusion


# References




